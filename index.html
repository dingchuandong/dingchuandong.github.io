<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="iOS">
<meta property="og:type" content="website">
<meta property="og:title" content="Snow Memory">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Snow Memory">
<meta property="og:description" content="iOS">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Snow Memory">
<meta name="twitter:description" content="iOS">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/"/>

  <title> Snow Memory </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Snow Memory</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">雪忆, 如雪般单纯, 冷静思考.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/06/11/小知识/" itemprop="url">
                  小知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-06-11T18:25:19+08:00" content="Jun 11 2018">
              Jun 11 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="小知识"><a href="#小知识" class="headerlink" title="小知识"></a>小知识</h1><h1 id="pragma-mark-获取当前view的viewcontroller"><a href="#pragma-mark-获取当前view的viewcontroller" class="headerlink" title="pragma mark - 获取当前view的viewcontroller"></a>pragma mark - 获取当前view的viewcontroller</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (UIViewController *)getCurrentViewController:(UIView *) currentView</div><div class="line">&#123;</div><div class="line">for (UIView* next = [currentView superview]; next; next = next.superview)</div><div class="line">&#123;</div><div class="line">UIResponder *nextResponder = [next nextResponder];</div><div class="line">if ([nextResponder isKindOfClass:[UIViewController class]])</div><div class="line">&#123;</div><div class="line">return (UIViewController *)nextResponder;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">return nil;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/12/item2常用快捷键/" itemprop="url">
                  item2常用快捷键
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-05-12T17:25:19+08:00" content="May 12 2018">
              May 12 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="item2常用快捷键"><a href="#item2常用快捷键" class="headerlink" title="item2常用快捷键"></a>item2常用快捷键</h2><h1 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">新建标签：command + t</div><div class="line">关闭标签：command + w</div><div class="line">切换标签：command + 数字 command + 左右方向键</div><div class="line">切换全屏：command + enter</div><div class="line">查找：command + f</div></pre></td></tr></table></figure>
<h1 id="分屏"><a href="#分屏" class="headerlink" title="分屏"></a>分屏</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">垂直分屏：command + d</div><div class="line">水平分屏：command + shift + d</div><div class="line">切换屏幕：command + option + 方向键 command + [ 或 command + ]</div><div class="line">查看历史命令：command + ;</div><div class="line">查看剪贴板历史：command + shift + h</div></pre></td></tr></table></figure>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">清除当前行：ctrl + u</div><div class="line">到行首：ctrl + a</div><div class="line">到行尾：ctrl + e</div><div class="line">前进后退：ctrl + f/b (相当于左右方向键)</div><div class="line">上一条命令：ctrl + p</div><div class="line">搜索命令历史：ctrl + r</div><div class="line">删除当前光标的字符：ctrl + d</div><div class="line">删除光标之前的字符：ctrl + h</div><div class="line">删除光标之前的单词：ctrl + w</div><div class="line">删除到文本末尾：ctrl + k</div><div class="line">交换光标处文本：ctrl + t</div><div class="line">清屏1：command + r</div><div class="line">清屏2：ctrl + l</div><div class="line">自带有哪些很实用的功能/快捷键</div><div class="line">⌘ + 数字在各 tab 标签直接来回切换</div><div class="line">选择即复制 + 鼠标中键粘贴，这个很实用</div><div class="line">⌘ + f 所查找的内容会被自动复制</div><div class="line">⌘ + d 横着分屏 / ⌘ + shift + d 竖着分屏</div><div class="line">⌘ + r = clear，而且只是换到新一屏，不会想 clear 一样创建一个空屏</div><div class="line">ctrl + u 清空当前行，无论光标在什么位置</div><div class="line">输入开头命令后 按 ⌘ + ; 会自动列出输入过的命令</div><div class="line">⌘ + shift + h 会列出剪切板历史</div><div class="line">可以在 Preferences &gt; keys 设置全局快捷键调出 iterm，这个也可以用过 Alfred 实现</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/17/RAC常见用法/" itemprop="url">
                  RAC常见用法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-04-17T17:29:19+08:00" content="Apr 17 2018">
              Apr 17 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="RAC常见用法"><a href="#RAC常见用法" class="headerlink" title="RAC常见用法"></a>RAC常见用法</h1><h2 id="代替代理"><a href="#代替代理" class="headerlink" title="代替代理"></a>代替代理</h2><ul>
<li>使用RAC代替代理时,rac_signalForSelecto:fromProtocol:这个代替代理的方法使用时,切记要将self设为代理这句话放在订阅代理信号的后面写,否则会无法执行<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">//这里订阅收到的是一个x,当一个页面存在多个tableview时,我们可以对x进行判断看是哪个tableview</div><div class="line">[[self rac_signalForSelector:@selector(tableView:didSelectRowAtIndexPath:) fromProtocol:@protocol(UITableViewDelegate) ] subscribeNext:^(RACTuple * x) &#123;</div><div class="line">NSLog(@&quot;点击了&quot;);</div><div class="line">NSLog(@&quot;%@,%@&quot;,x.first,x.second);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//这样子不带协议是无法代替代理的,虽然能达到效果,这个方法表示某个selector被调用时执行一段代码.带有协议参数的表示该selector实现了某个协议，所以可以用它来实现Delegate。</div><div class="line">//    [[self rac_signalForSelector:@selector(tableView:didSelectRowAtIndexPath:)] subscribeNext:^(RACTuple* x) &#123;</div><div class="line">//        NSLog(@&quot;%@&quot;,[x class]);</div><div class="line">//        NSLog(@&quot;%@&quot;,x);</div><div class="line">//    &#125;];</div><div class="line"></div><div class="line">//这里是个坑,必须将代理最后设置,否则信号是无法订阅到的</div><div class="line">//雷纯峰大大是这样子解释的:在设置代理的时候，系统会缓存这个代理对象实现了哪些代码方法</div><div class="line">//如果将代理放在订阅信号前设置,那么当控制器成为代理时是无法缓存这个代理对象实现了哪些代码方法的</div><div class="line">tableview.delegate = self;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="KVO"><a href="#KVO" class="headerlink" title="KVO"></a>KVO</h2><ul>
<li>使用RAC代替KVO很简单,一句话就可以搞定,而且相比传统的KVO,不仅代码不用放在一起写美观了很多,同时还能达到高聚合低耦合的目标。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//代替KVO</div><div class="line">[RACObserve(scrollView, contentOffset) subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;,x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="监听事件"><a href="#监听事件" class="headerlink" title="监听事件"></a>监听事件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[[btn rac_signalForControlEvents:UIControlEventTouchUpInside] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;点击了按钮&quot;);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h2 id="通知"><a href="#通知" class="headerlink" title="通知"></a>通知</h2><ul>
<li>这里是有个坑的,单纯的写完订阅通知的信号会发现每次都会执行,而且叠加次数会增加,效果如图所示,所以我们要想办法把通知订阅的信号给释放掉,所以用到了takeUntil这个方法。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//takeUntil会接收一个signal,当signal触发后会把之前的信号释放掉</div><div class="line">[[[[NSNotificationCenter defaultCenter] rac_addObserverForName:UIKeyboardDidShowNotification object:nil] takeUntil:self.rac_willDeallocSignal] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;键盘弹出&quot;);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h2><ul>
<li><p>延时执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//五秒后执行一次</div><div class="line">[[RACScheduler mainThreadScheduler]afterDelay:5 schedule:^&#123;</div><div class="line">NSLog(@&quot;五秒后执行一次&quot;);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
<li><p>定时执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//每隔两秒执行一次</div><div class="line">//这里要加takeUntil条件限制一下否则当控制器pop后依旧会执行</div><div class="line">[[[RACSignal interval:2 onScheduler:[RACScheduler mainThreadScheduler]] takeUntil:self.rac_willDeallocSignal ] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;每两秒执行一次&quot;);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="监听文本框的文字改变"><a href="#监听文本框的文字改变" class="headerlink" title="监听文本框的文字改变"></a>监听文本框的文字改变</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[_textField.rac_textSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;文字改变了%@&quot;,x);</div><div class="line">&#125;]</div></pre></td></tr></table></figure>
<h2 id="处理多个请求，都返回结果的时候，统一做处理"><a href="#处理多个请求，都返回结果的时候，统一做处理" class="headerlink" title="处理多个请求，都返回结果的时候，统一做处理"></a>处理多个请求，都返回结果的时候，统一做处理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">RACSignal *request1 = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求1</div><div class="line">[subscriber sendNext:@&quot;发送请求1&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">RACSignal *request2 = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求2</div><div class="line">[subscriber sendNext:@&quot;发送请求2&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 使用注意：几个信号，参数一的方法就几个参数，每个参数对应信号发出的数据。</div><div class="line">[self rac_liftSelector:@selector(updateUIWithR1:r2:) withSignalsFromArray:@[request1,request2]];</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/07/RAC 使用小结/" itemprop="url">
                  RAC常见用法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-04-07T12:25:19+08:00" content="Apr 7 2018">
              Apr 7 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="RAC常见用法"><a href="#RAC常见用法" class="headerlink" title="RAC常见用法"></a>RAC常见用法</h1><h2 id="RACSignal"><a href="#RACSignal" class="headerlink" title="- RACSignal"></a>- RACSignal</h2><h2 id="RACSubject"><a href="#RACSubject" class="headerlink" title="- RACSubject"></a>- RACSubject</h2><h2 id="RACSequence"><a href="#RACSequence" class="headerlink" title="- RACSequence"></a>- RACSequence</h2><h2 id="RACMulticastConnection"><a href="#RACMulticastConnection" class="headerlink" title="- RACMulticastConnection"></a>- RACMulticastConnection</h2><h2 id="RACCommand"><a href="#RACCommand" class="headerlink" title="- RACCommand"></a>- RACCommand</h2><h2 id="RAC常用宏"><a href="#RAC常用宏" class="headerlink" title="- RAC常用宏"></a>- RAC常用宏</h2><h2 id="RAC-bind"><a href="#RAC-bind" class="headerlink" title="- RAC-bind"></a>- RAC-bind</h2><h2 id="RAC-过滤"><a href="#RAC-过滤" class="headerlink" title="- RAC-过滤"></a>- RAC-过滤</h2><h2 id="RAC-映射"><a href="#RAC-映射" class="headerlink" title="- RAC-映射"></a>- RAC-映射</h2><h2 id="RAC-组合"><a href="#RAC-组合" class="headerlink" title="- RAC-组合"></a>- RAC-组合</h2><h1 id="RACSignal-1"><a href="#RACSignal-1" class="headerlink" title="- RACSignal"></a>- RACSignal</h1><h1 id="一-核心"><a href="#一-核心" class="headerlink" title="一.核心"></a>一.核心</h1><h2 id="1-信号类"><a href="#1-信号类" class="headerlink" title="1.信号类"></a>1.信号类</h2><h2 id="2-作用：只要有数据改变就会把数据包装成信号传递出去"><a href="#2-作用：只要有数据改变就会把数据包装成信号传递出去" class="headerlink" title="2.作用：只要有数据改变就会把数据包装成信号传递出去"></a>2.作用：只要有数据改变就会把数据包装成信号传递出去</h2><h2 id="3-只要有数据改变就会有信号发出"><a href="#3-只要有数据改变就会有信号发出" class="headerlink" title="3.只要有数据改变就会有信号发出"></a>3.只要有数据改变就会有信号发出</h2><h2 id="4-数据发出，并不是信号类发出，信号类不能发送数据"><a href="#4-数据发出，并不是信号类发出，信号类不能发送数据" class="headerlink" title="4.数据发出，并不是信号类发出，信号类不能发送数据"></a>4.数据发出，并不是信号类发出，信号类不能发送数据</h2><h1 id="二-使用"><a href="#二-使用" class="headerlink" title="二.使用"></a>二.使用</h1><h2 id="1-创建信号"><a href="#1-创建信号" class="headerlink" title="1.创建信号"></a>1.创建信号</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// 1.创建信号</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 3.发送信号</div><div class="line">[subscriber sendNext:@&quot;ws&quot;];</div><div class="line">// 4.取消信号，如果信号想要被取消，就必须返回一个RACDisposable</div><div class="line">// 信号什么时候被取消：1.自动取消，当一个信号的订阅者被销毁的时候机会自动取消订阅，2.手动取消，</div><div class="line">//block什么时候调用：一旦一个信号被取消订阅就会调用</div><div class="line">//block作用：当信号被取消时用于清空一些资源</div><div class="line">return [RACDisposable disposableWithBlock:^&#123;</div><div class="line">NSLog(@&quot;取消订阅&quot;);</div><div class="line">&#125;];</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h2 id="2-订阅信号-才能激活信号"><a href="#2-订阅信号-才能激活信号" class="headerlink" title="2.订阅信号(才能激活信号)"></a>2.订阅信号(才能激活信号)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 2. 订阅信号</div><div class="line">//subscribeNext</div><div class="line">// 把nextBlock保存到订阅者里面</div><div class="line">// 只要订阅信号就会返回一个取消订阅信号的类</div><div class="line">RACDisposable *disposable = [signal subscribeNext:^(id x) &#123;</div><div class="line">// block的调用时刻：只要信号内部发出数据就会调用这个block</div><div class="line">NSLog(@&quot;======%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 取消订阅</div><div class="line">[disposable dispose]</div></pre></td></tr></table></figure>
<h3 id="RACSignal底层实现"><a href="#RACSignal底层实现" class="headerlink" title="RACSignal底层实现 :"></a>RACSignal底层实现 :</h3><h4 id="1、创建信号，首先把didSubscribe保存到信号中，还不会触发"><a href="#1、创建信号，首先把didSubscribe保存到信号中，还不会触发" class="headerlink" title="1、创建信号，首先把didSubscribe保存到信号中，还不会触发."></a>1、创建信号，首先把didSubscribe保存到信号中，还不会触发.</h4><h4 id="2、当信号被订阅，也就是调用signal的subscribrNext：nextBlock，-subscribeNext内部会创建订阅者subscriber，并把nextBlock保存到subscriber中，subscribNext内部会调用signal的didSubscribe"><a href="#2、当信号被订阅，也就是调用signal的subscribrNext：nextBlock，-subscribeNext内部会创建订阅者subscriber，并把nextBlock保存到subscriber中，subscribNext内部会调用signal的didSubscribe" class="headerlink" title="2、当信号被订阅，也就是调用signal的subscribrNext：nextBlock， subscribeNext内部会创建订阅者subscriber，并把nextBlock保存到subscriber中，subscribNext内部会调用signal的didSubscribe"></a>2、当信号被订阅，也就是调用signal的subscribrNext：nextBlock， subscribeNext内部会创建订阅者subscriber，并把nextBlock保存到subscriber中，subscribNext内部会调用signal的didSubscribe</h4><h4 id="3、signal的didsubcribe中调用【subscriber-sendNext：-”发送数据”】，sendNext底层其实就是执行subscriber的nextBlock。"><a href="#3、signal的didsubcribe中调用【subscriber-sendNext：-”发送数据”】，sendNext底层其实就是执行subscriber的nextBlock。" class="headerlink" title="3、signal的didsubcribe中调用【subscriber sendNext：@”发送数据”】，sendNext底层其实就是执行subscriber的nextBlock。"></a>3、signal的didsubcribe中调用【subscriber sendNext：@”发送数据”】，sendNext底层其实就是执行subscriber的nextBlock。</h4><h1 id="RACSubject（热信号）"><a href="#RACSubject（热信号）" class="headerlink" title="- RACSubject（热信号）"></a>- RACSubject（热信号）</h1><h2 id="RACSubject继承于RACSignal遵守了RACSubscriber协议可以完全用RACSubject代替代理-通知-与-RACSignal-以及-RACSequence-有着众多的类簇不同，RACSubject-在整个工程中并没有多少子类；不过，在大多数情况下，我们也只会使用-RACSubject-自己或者-RACReplaySubject-是一个可以『手动』控制的信号"><a href="#RACSubject继承于RACSignal遵守了RACSubscriber协议可以完全用RACSubject代替代理-通知-与-RACSignal-以及-RACSequence-有着众多的类簇不同，RACSubject-在整个工程中并没有多少子类；不过，在大多数情况下，我们也只会使用-RACSubject-自己或者-RACReplaySubject-是一个可以『手动』控制的信号" class="headerlink" title="RACSubject继承于RACSignal遵守了RACSubscriber协议可以完全用RACSubject代替代理 /通知,与 RACSignal 以及 RACSequence 有着众多的类簇不同，RACSubject 在整个工程中并没有多少子类；不过，在大多数情况下，我们也只会使用 RACSubject 自己或者 RACReplaySubject,是一个可以『手动』控制的信号"></a>RACSubject继承于RACSignal遵守了RACSubscriber协议可以完全用RACSubject代替代理 /通知,与 RACSignal 以及 RACSequence 有着众多的类簇不同，RACSubject 在整个工程中并没有多少子类；不过，在大多数情况下，我们也只会使用 RACSubject 自己或者 RACReplaySubject,是一个可以『手动』控制的信号</h2><h3 id="相比于-RACSignal-丰富的头文件-，RACSubject对外的接口并没有提供太多的方法："><a href="#相比于-RACSignal-丰富的头文件-，RACSubject对外的接口并没有提供太多的方法：" class="headerlink" title="相比于 RACSignal 丰富的头文件 ，RACSubject对外的接口并没有提供太多的方法："></a>相比于 RACSignal 丰富的头文件 ，RACSubject对外的接口并没有提供太多的方法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@interface RACSubject : RACSignal &lt;RACSubscriber&gt;</div><div class="line">+ (instancetype)subject;</div><div class="line">@end</div></pre></td></tr></table></figure>
<h3 id="唯一提供的接口就是用于返回一个新实例的-subject-方法；除此之外，在笔者看来它与-RACSignal-最大的不同就是：RACSubject-实现了-RACSubscriber-协议，也就是下面的这些方法："><a href="#唯一提供的接口就是用于返回一个新实例的-subject-方法；除此之外，在笔者看来它与-RACSignal-最大的不同就是：RACSubject-实现了-RACSubscriber-协议，也就是下面的这些方法：" class="headerlink" title="唯一提供的接口就是用于返回一个新实例的 +subject 方法；除此之外，在笔者看来它与 RACSignal 最大的不同就是：RACSubject 实现了 RACSubscriber 协议，也就是下面的这些方法："></a>唯一提供的接口就是用于返回一个新实例的 +subject 方法；除此之外，在笔者看来它与 RACSignal 最大的不同就是：RACSubject 实现了 RACSubscriber 协议，也就是下面的这些方法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@protocol RACSubscriber &lt;NSObject&gt;</div><div class="line">@required</div><div class="line">- (void)sendNext:(nullable id)value;</div><div class="line">- (void)sendError:(nullable NSError *)error;</div><div class="line">- (void)sendCompleted;</div><div class="line">- (void)didSubscribeWithDisposable:(RACCompoundDisposable *)disposable;</div><div class="line">@end</div></pre></td></tr></table></figure>
<h3 id="我们并不能在一个-RACSignal-对象上执行这些方法，只能在创建信号的-block-里面向遵循-RACSubscriber-协议的对象发送新的值或者错误，这也是-RACSubject-和父类最大的不同：在-RACSubject-实例初始化之后，也可以通过这个实例向所有的订阅者发送消息。"><a href="#我们并不能在一个-RACSignal-对象上执行这些方法，只能在创建信号的-block-里面向遵循-RACSubscriber-协议的对象发送新的值或者错误，这也是-RACSubject-和父类最大的不同：在-RACSubject-实例初始化之后，也可以通过这个实例向所有的订阅者发送消息。" class="headerlink" title="我们并不能在一个 RACSignal 对象上执行这些方法，只能在创建信号的 block 里面向遵循 RACSubscriber 协议的对象发送新的值或者错误，这也是 RACSubject 和父类最大的不同：在 RACSubject 实例初始化之后，也可以通过这个实例向所有的订阅者发送消息。"></a>我们并不能在一个 RACSignal 对象上执行这些方法，只能在创建信号的 block 里面向遵循 RACSubscriber 协议的对象发送新的值或者错误，这也是 RACSubject 和父类最大的不同：在 RACSubject 实例初始化之后，也可以通过这个实例向所有的订阅者发送消息。</h3><h2 id="1-创建信号-跟RACSignal不一样，创建信号时没有block。"><a href="#1-创建信号-跟RACSignal不一样，创建信号时没有block。" class="headerlink" title="1.创建信号 跟RACSignal不一样，创建信号时没有block。"></a>1.创建信号 跟RACSignal不一样，创建信号时没有block。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RACSubject *subject = [RACSubject subject];</div></pre></td></tr></table></figure>
<h2 id="2-订阅信号-调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了"><a href="#2-订阅信号-调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了" class="headerlink" title="2.订阅信号(调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了)"></a>2.订阅信号(调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[subject subscribeNext:^(id x) &#123;</div><div class="line">// block:当有数据发出的时候就会调用</div><div class="line">// block:处理数据</div><div class="line">NSLog(@&quot;%@&quot;,x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h2 id="3-发送信号-调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了"><a href="#3-发送信号-调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了" class="headerlink" title="3.发送信号(调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了)"></a>3.发送信号(调用subscribeNext订阅信号，只是把订阅者保存起来，并且订阅者的nextBlock已经赋值了)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[subject sendNext:value];</div></pre></td></tr></table></figure>
<h2 id="注意-RACSubject-在-RACSignal-对象之上进行了简单的修改，将原有的冷信号改造成了热信号，将不可变变成了可变。"><a href="#注意-RACSubject-在-RACSignal-对象之上进行了简单的修改，将原有的冷信号改造成了热信号，将不可变变成了可变。" class="headerlink" title="注意 RACSubject 在 RACSignal 对象之上进行了简单的修改，将原有的冷信号改造成了热信号，将不可变变成了可变。"></a>注意 RACSubject 在 RACSignal 对象之上进行了简单的修改，将原有的冷信号改造成了热信号，将不可变变成了可变。</h2><h2 id="RACBehaviorSubject与RACReplaySubject"><a href="#RACBehaviorSubject与RACReplaySubject" class="headerlink" title="RACBehaviorSubject与RACReplaySubject"></a>RACBehaviorSubject与RACReplaySubject</h2><h3 id="RACBehaviorSubject和RACReplaySubject是RACSubject的两个子类，前者在订阅时会向订阅者发送最新的消息，后者在订阅之后可以重新发送之前的所有消息序列。"><a href="#RACBehaviorSubject和RACReplaySubject是RACSubject的两个子类，前者在订阅时会向订阅者发送最新的消息，后者在订阅之后可以重新发送之前的所有消息序列。" class="headerlink" title="RACBehaviorSubject和RACReplaySubject是RACSubject的两个子类，前者在订阅时会向订阅者发送最新的消息，后者在订阅之后可以重新发送之前的所有消息序列。"></a>RACBehaviorSubject和RACReplaySubject是RACSubject的两个子类，前者在订阅时会向订阅者发送最新的消息，后者在订阅之后可以重新发送之前的所有消息序列。</h3><h3 id="先来介绍两者中实现较简单的RACBehaviorSubject，它在内部会保存一个currentValue-对象，也就是最后一次发送的消息："><a href="#先来介绍两者中实现较简单的RACBehaviorSubject，它在内部会保存一个currentValue-对象，也就是最后一次发送的消息：" class="headerlink" title="先来介绍两者中实现较简单的RACBehaviorSubject，它在内部会保存一个currentValue 对象，也就是最后一次发送的消息："></a>先来介绍两者中实现较简单的RACBehaviorSubject，它在内部会保存一个currentValue 对象，也就是最后一次发送的消息：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@interface RACBehaviorSubject ()</div><div class="line">@property (nonatomic, strong) id currentValue;</div><div class="line">@end</div></pre></td></tr></table></figure>
<h4 id="在每次执行-sendNext-时，都会对-RACBehaviorSubject-中保存的-currentValue进行更新，并使用父类的-sendNext-方法，向所有的订阅者发送最新的消息："><a href="#在每次执行-sendNext-时，都会对-RACBehaviorSubject-中保存的-currentValue进行更新，并使用父类的-sendNext-方法，向所有的订阅者发送最新的消息：" class="headerlink" title="在每次执行-sendNext:时，都会对 RACBehaviorSubject 中保存的 currentValue进行更新，并使用父类的 -sendNext:方法，向所有的订阅者发送最新的消息："></a>在每次执行<code>-sendNext:</code>时，都会对 <code>RACBehaviorSubject</code> 中保存的 <code>currentValue</code>进行更新，并使用父类的 <code>-sendNext:</code>方法，向所有的订阅者发送最新的消息：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (void)sendNext:(id)value &#123;</div><div class="line">@synchronized (self) &#123;</div><div class="line">self.currentValue = value;</div><div class="line">[super sendNext:value];</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="RACBehaviorSubject最重要的特性就是在订阅时，向最新的订阅者发送之前的消息，这是通过覆写-subscribe-方法实现的。在调用子类的-subscribe-方法之后，会在subscriber对象上执行-sendNext-方法："><a href="#RACBehaviorSubject最重要的特性就是在订阅时，向最新的订阅者发送之前的消息，这是通过覆写-subscribe-方法实现的。在调用子类的-subscribe-方法之后，会在subscriber对象上执行-sendNext-方法：" class="headerlink" title="RACBehaviorSubject最重要的特性就是在订阅时，向最新的订阅者发送之前的消息，这是通过覆写-subscribe:方法实现的。在调用子类的-subscribe:方法之后，会在subscriber对象上执行-sendNext: 方法："></a><code>RACBehaviorSubject</code>最重要的特性就是在订阅时，向最新的订阅者发送之前的消息，这是通过覆写<code>-subscribe:</code>方法实现的。在调用子类的<code>-subscribe:</code>方法之后，会在<code>subscriber</code>对象上执行<code>-sendNext:</code> 方法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (RACDisposable *)subscribe:(id&lt;RACSubscriber&gt;)subscriber &#123;</div><div class="line">RACDisposable *subscriptionDisposable = [super subscribe:subscriber];</div><div class="line"></div><div class="line">RACDisposable *schedulingDisposable = [RACScheduler.subscriptionScheduler schedule:^&#123;</div><div class="line">@synchronized (self) &#123;</div><div class="line">[subscriber sendNext:self.currentValue];</div><div class="line">&#125;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">return [RACDisposable disposableWithBlock:^&#123;</div><div class="line">[subscriptionDisposable dispose];</div><div class="line">[schedulingDisposable dispose];</div><div class="line">&#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="RACReplaySubject相当于一个自带buffer-的RACBehaviorSubject，它可以在每次有新的订阅者订阅之后发送之前的全部消息。"><a href="#RACReplaySubject相当于一个自带buffer-的RACBehaviorSubject，它可以在每次有新的订阅者订阅之后发送之前的全部消息。" class="headerlink" title="RACReplaySubject相当于一个自带buffer 的RACBehaviorSubject，它可以在每次有新的订阅者订阅之后发送之前的全部消息。"></a>RACReplaySubject相当于一个自带buffer 的RACBehaviorSubject，它可以在每次有新的订阅者订阅之后发送之前的全部消息。</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@interface RACReplaySubject ()</div><div class="line">@property (nonatomic,assign,readonly)NSUInteger capacity;</div><div class="line">@property (nonatomic, strong,readonly) NSMutableArray*valuesReceived;</div><div class="line">@end</div></pre></td></tr></table></figure>
<h2 id="RACSequence-1"><a href="#RACSequence-1" class="headerlink" title="RACSequence"></a>RACSequence</h2><h3 id="高效的遍历数组和字典"><a href="#高效的遍历数组和字典" class="headerlink" title="高效的遍历数组和字典"></a>高效的遍历数组和字典</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">NSArray *dictArr = [[NSArray alloc] initWithObjects:@&quot;1&quot;,@&quot;2&quot;,@&quot;3&quot;,@&quot;4&quot;,@&quot;5&quot;,@&quot;6&quot;, nil];</div><div class="line">[dictArr.rac_sequence.signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">NSLog(@&quot;===error===&quot;);</div><div class="line">&#125; completed:^&#123;</div><div class="line">NSLog(@&quot;ok---完毕&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//也可以使用宏</div><div class="line">NSDictionary *dict = @&#123;@&quot;key&quot;:@1, @&quot;key2&quot;:@2&#125;;</div><div class="line">[dict.rac_sequence.signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">NSString *key = x[0];</div><div class="line">NSString *value = x[1];</div><div class="line">// RACTupleUnpack宏：专门用来解析元组</div><div class="line">// RACTupleUnpack 等会右边：需要解析的元组 宏的参数，填解析的什么样数据</div><div class="line">// 元组里面有几个值，宏的参数就必须填几个</div><div class="line">// RACTupleUnpack(NSString *key, NSString *value) = x;</div><div class="line">NSLog(@&quot;%@ %@&quot;, key, value);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">NSLog(@&quot;===error&quot;);</div><div class="line">&#125; completed:^&#123;</div><div class="line">NSLog(@&quot;-----ok---完毕&quot;);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h2 id="RACMulticastConnection-1"><a href="#RACMulticastConnection-1" class="headerlink" title="RACMulticastConnection"></a>RACMulticastConnection</h2><h3 id="当有多个订阅者，但是我们只想发送一个信号的时候怎么办？这时我们就可以用RACMulticastConnection，来实现。代码示例如下"><a href="#当有多个订阅者，但是我们只想发送一个信号的时候怎么办？这时我们就可以用RACMulticastConnection，来实现。代码示例如下" class="headerlink" title="当有多个订阅者，但是我们只想发送一个信号的时候怎么办？这时我们就可以用RACMulticastConnection，来实现。代码示例如下:"></a>当有多个订阅者，但是我们只想发送一个信号的时候怎么办？这时我们就可以用RACMulticastConnection，来实现。代码示例如下:</h3><h4 id="1-普通写法"><a href="#1-普通写法" class="headerlink" title="1.普通写法:"></a>1.普通写法:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// 这样的缺点是：每订阅一次信号就得重新创建并发送请求，这样很不友好</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// didSubscribeblock中的代码都统称为副作用。</div><div class="line">// 发送请求---比如afn</div><div class="line">NSLog(@&quot;发送请求啦&quot;);</div><div class="line">// 发送信号</div><div class="line">[subscriber sendNext:@&quot;ws&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h4 id="比较好的写法"><a href="#比较好的写法" class="headerlink" title="比较好的写法:"></a>比较好的写法:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// 使用RACMulticastConnection，无论有多少个订阅者，无论订阅多少次，我只发送一个。</div><div class="line">// 1.发送请求，用一个信号内包装，不管有多少个订阅者，只想发一次请求</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求</div><div class="line">NSLog(@&quot;发送请求啦&quot;);</div><div class="line">// 发送信号</div><div class="line">[subscriber sendNext:@&quot;ws&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">//2. 创建连接类</div><div class="line">RACMulticastConnection *connection = [signal publish];</div><div class="line">[connection.signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">[connection.signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">[connection.signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">//3. 连接。只有连接了才会把信号源变为热信号</div><div class="line">[connection connect];</div></pre></td></tr></table></figure>
<h4 id="大概原理"><a href="#大概原理" class="headerlink" title="大概原理 :"></a>大概原理 :</h4><ul>
<li>1.创建connect，connect.sourceSignal -&gt; RACSignal(原始信号)  connect.signal -&gt; RACSubject     </li>
<li>2.订阅connect.signal，会调用RACSubject的subscribeNext，创建订阅者，而且把订阅者保存起来，不会执行block。     </li>
<li>3.[connect connect]内部会订阅RACSignal(原始信号)，并且订阅者是RACSubject     </li>
<li>3.1.订阅原始信号，就会调用原始信号中的didSubscribe     </li>
<li>3.2 didSubscribe，拿到订阅者调用sendNext，其实是调用RACSubject的sendNext     </li>
<li>4.RACSubject的sendNext,会遍历RACSubject所有订阅者发送信号。    </li>
<li>4.1 因为刚刚第二步，都是在订阅RACSubject，因此会拿到第二步所有的订阅者，调用他们的nextBlock</li>
<li><h3 id="RACCommand-1"><a href="#RACCommand-1" class="headerlink" title="RACCommand"></a>RACCommand</h3><h4 id="RACCommand-RAC中用于处理事件的类，可以把事件如何处理，事件中的数据如何传递，包装到这个类中，他可以很方便的监控事件的执行过程，比如看事件有没有执行完毕"><a href="#RACCommand-RAC中用于处理事件的类，可以把事件如何处理，事件中的数据如何传递，包装到这个类中，他可以很方便的监控事件的执行过程，比如看事件有没有执行完毕" class="headerlink" title="RACCommand:RAC中用于处理事件的类，可以把事件如何处理，事件中的数据如何传递，包装到这个类中，他可以很方便的监控事件的执行过程，比如看事件有没有执行完毕"></a>RACCommand:RAC中用于处理事件的类，可以把事件如何处理，事件中的数据如何传递，包装到这个类中，他可以很方便的监控事件的执行过程，比如看事件有没有执行完毕</h4><h4 id="使用场景-监听按钮点击，网络请求"><a href="#使用场景-监听按钮点击，网络请求" class="headerlink" title="使用场景:监听按钮点击，网络请求"></a>使用场景:监听按钮点击，网络请求</h4></li>
<li><p>普通做法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">// RACCommand: 处理事件</div><div class="line">// 不能返回空的信号</div><div class="line">// 1.创建命令</div><div class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) &#123;</div><div class="line">//block调用，执行命令的时候就会调用</div><div class="line">NSLog(@&quot;%@&quot;,input);</div><div class="line">// input 为执行命令传进来的参数</div><div class="line">// 这里的返回值不允许为nil</div><div class="line">return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">[subscriber sendNext:@&quot;执行命令产生的数据&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 如何拿到执行命令中产生的数据呢？</div><div class="line">// 订阅命令内部的信号</div><div class="line">// ** 方式一：直接订阅执行命令返回的信号</div><div class="line">// 2.执行命令</div><div class="line">RACSignal *signal =[command execute:@2];</div><div class="line">// 这里其实用到的是replaySubject 可以先发送命令再订阅</div><div class="line">// 在这里就可以订阅信号了</div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;,x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
<li><p>一般做法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// 1.创建命令</div><div class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) &#123;</div><div class="line">//block调用，执行命令的时候就会调用</div><div class="line">NSLog(@&quot;%@&quot;,input); // input 为执行命令传进来的参数</div><div class="line">// 这里的返回值不允许为nil</div><div class="line">return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">[subscriber sendNext:@&quot;执行命令产生的数据&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 订阅信号</div><div class="line">// 注意：这里必须是先订阅才能发送命令</div><div class="line">// executionSignals：信号源，信号中信号，signalofsignals:信号，发送数据就是信号</div><div class="line">[command.executionSignals subscribeNext:^(RACSignal *x) &#123;</div><div class="line">[x subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">//        NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 2.执行命令</div><div class="line">[command execute:@2];</div></pre></td></tr></table></figure>
</li>
<li><p>高级做法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// 1.创建命令</div><div class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) &#123;</div><div class="line">// block调用：执行命令的时候就会调用</div><div class="line">NSLog(@&quot;%@&quot;, input);</div><div class="line">// 这里的返回值不允许为nil</div><div class="line">return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">[subscriber sendNext:@&quot;发送信号&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 方式三</div><div class="line">// switchToLatest获取最新发送的信号，只能用于信号中信号。</div><div class="line">[command.executionSignals.switchToLatest subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 2.执行命令</div><div class="line">[command execute:@3];</div></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// switchToLatest--用于信号中信号</div><div class="line">// 创建信号中信号</div><div class="line">RACSubject *signalofsignals = [RACSubject subject];</div><div class="line">RACSubject *signalA = [RACSubject subject];</div><div class="line">// 订阅信号</div><div class="line">//    [signalofsignals subscribeNext:^(RACSignal *x) &#123;</div><div class="line">//        [x subscribeNext:^(id x) &#123;</div><div class="line">//            NSLog(@&quot;%@&quot;, x);</div><div class="line">//        &#125;];</div><div class="line">//    &#125;];</div><div class="line">// switchToLatest: 获取信号中信号发送的最新信号</div><div class="line">[signalofsignals.switchToLatest subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[signalofsignals sendNext:signalA];</div><div class="line">[signalA sendNext:@4];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">// 监听事件有没有完成</div><div class="line">//注意：当前命令内部发送数据完成，一定要主动发送完成</div><div class="line">// 1.创建命令</div><div class="line">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) &#123;</div><div class="line">// block调用：执行命令的时候就会调用</div><div class="line">NSLog(@&quot;%@&quot;, input);</div><div class="line">// 这里的返回值不允许为nil</div><div class="line">return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送数据</div><div class="line">[subscriber sendNext:@&quot;执行命令产生的数据&quot;];</div><div class="line"></div><div class="line">// *** 发送完成 **</div><div class="line">[subscriber sendCompleted];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">&#125;];</div><div class="line">// 监听事件有没有完成</div><div class="line">[command.executing subscribeNext:^(id x) &#123;</div><div class="line">if ([x boolValue] == YES) &#123; // 正在执行</div><div class="line">NSLog(@&quot;当前正在执行%@&quot;, x);</div><div class="line">&#125;else &#123;</div><div class="line">// 执行完成/没有执行</div><div class="line">NSLog(@&quot;执行完成/没有执行&quot;);</div><div class="line">&#125;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 2.执行命令</div><div class="line">[command execute:@1];</div></pre></td></tr></table></figure>
<h2 id="RAC常用宏-1"><a href="#RAC常用宏-1" class="headerlink" title="RAC常用宏"></a>RAC常用宏</h2><h3 id="RAC有许多强大而方便的宏。如下"><a href="#RAC有许多强大而方便的宏。如下" class="headerlink" title="RAC有许多强大而方便的宏。如下:"></a>RAC有许多强大而方便的宏。如下:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// RAC:把一个对象的某个属性绑定一个信号,只要发出信号,就会把信号的内容给对象的属性赋值</div><div class="line">// 给label的text属性绑定了文本框改变的信号</div><div class="line">RAC(self.label, text) = self.textField.rac_textSignal;</div><div class="line">//    [self.textField.rac_textSignal subscribeNext:^(id x) &#123;</div><div class="line">//        self.label.text = x;</div><div class="line">//    &#125;];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">*  KVO</div><div class="line">*  RACObserveL:快速的监听某个对象的某个属性改变</div><div class="line">*  返回的是一个信号,对象的某个属性改变的信号</div><div class="line">*/</div><div class="line">[RACObserve(self.view, center) subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//例 textField输入的值赋值给label，监听label文字改变,</div><div class="line">RAC(self.label, text) = self.textField.rac_textSignal;</div><div class="line">[RACObserve(self.label, text) subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;====label的文字变了&quot;);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">*  循环引用问题</div><div class="line">*/</div><div class="line">@weakify(self)</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">@strongify(self)</div><div class="line">NSLog(@&quot;%@&quot;,self.view);</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">_signal = signal;</div><div class="line">使用 @weakify(self)和@strongify(self)来避免循环引用</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* 元祖</div><div class="line">* 快速包装一个元组</div><div class="line">* 把包装的类型放在宏的参数里面,就会自动包装</div><div class="line">*/</div><div class="line">RACTuple *tuple = RACTuplePack(@1,@2,@4);</div><div class="line">// 宏的参数类型要和元祖中元素类型一致， 右边为要解析的元祖。</div><div class="line">RACTupleUnpack_(NSNumber *num1, NSNumber *num2, NSNumber * num3) = tuple;// 4.元祖</div><div class="line">// 快速包装一个元组</div><div class="line">// 把包装的类型放在宏的参数里面,就会自动包装</div><div class="line">NSLog(@&quot;%@ %@ %@&quot;, num1, num2, num3);</div></pre></td></tr></table></figure>
<h2 id="RAC-bind-1"><a href="#RAC-bind-1" class="headerlink" title="RAC-bind"></a>RAC-bind</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">// 1.创建信号</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">// 2.绑定信号</div><div class="line">RACSignal *bindSignal = [subject bind:^RACStreamBindBlock&#123;</div><div class="line">// block调用时刻：只要绑定信号订阅就会调用。不做什么事情，</div><div class="line">return ^RACSignal *(id value, BOOL *stop)&#123;</div><div class="line">// 一般在这个block中做事 ，发数据的时候会来到这个block。</div><div class="line">// 只要源信号（subject）发送数据，就会调用block</div><div class="line">// block作用：处理源信号内容</div><div class="line">// value:源信号发送的内容，</div><div class="line">value = @3; // 如果在这里把value的值改了，那么订阅绑定信号的值即44行的x就变了</div><div class="line">NSLog(@&quot;接受到源信号的内容：%@&quot;, value);</div><div class="line">//返回信号，不能为nil,如果非要返回空---则empty或 alloc init。</div><div class="line">return [RACReturnSignal return:value]; // 把返回的值包装成信号</div><div class="line">&#125;;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 3.订阅绑定信号</div><div class="line">[bindSignal subscribeNext:^(id x) &#123;</div><div class="line"></div><div class="line">NSLog(@&quot;接收到绑定信号处理完的信号:%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 4.发送信号</div><div class="line">[subject sendNext:@&quot;123&quot;];</div></pre></td></tr></table></figure>
<ul>
<li>bind（绑定）的使用思想和Hook的一样—&gt; 都是拦截API从而可以对数据进行操作，而影响返回数据。</li>
<li>发送信号的时候会来到30行的block。在这个block里我们可以对数据进行一些操作，那么35行打印的value和订阅绑定信号后的value就会变了。<h2 id="RAC-过滤-1"><a href="#RAC-过滤-1" class="headerlink" title="RAC-过滤"></a>RAC-过滤</h2><h3 id="有时候我们想要过滤一些信号，这时候我们便可以用RAC的过滤方法。过滤方法有好多种，如下代码，从不同情况下进行了分析。"><a href="#有时候我们想要过滤一些信号，这时候我们便可以用RAC的过滤方法。过滤方法有好多种，如下代码，从不同情况下进行了分析。" class="headerlink" title="有时候我们想要过滤一些信号，这时候我们便可以用RAC的过滤方法。过滤方法有好多种，如下代码，从不同情况下进行了分析。"></a>有时候我们想要过滤一些信号，这时候我们便可以用RAC的过滤方法。过滤方法有好多种，如下代码，从不同情况下进行了分析。</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 跳跃 ： 如下，skip传入2 跳过前面两个值</div><div class="line">// 实际用处： 在实际开发中比如 后台返回的数据前面几个没用，我们想跳跃过去，便可以用skip</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[[subject skip:2] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendNext:@3];</div></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//distinctUntilChanged:-- 如果当前的值跟上一次的值一样，就不会被订阅到</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[[subject distinctUntilChanged] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendNext:@2]; // 不会被订阅</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// take:可以屏蔽一些值,去掉前面几个值---这里take为2 则只拿到前两个值</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[[subject take:2] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendNext:@3];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//takeLast:和take的用法一样，不过他取的是最后的几个值，如下，则取的是最后两个值</div><div class="line">//注意点:takeLast 一定要调用sendCompleted，告诉他发送完成了，这样才能取到最后的几个值</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[[subject takeLast:2] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendNext:@3];</div><div class="line">[subject sendCompleted];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// takeUntil:---给takeUntil传的是哪个信号，那么当这个信号发送信号或sendCompleted，就不能再接受源信号的内容了。</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">RACSubject *subject2 = [RACSubject subject];</div><div class="line">[[subject takeUntil:subject2] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject2 sendNext:@3];  // 1</div><div class="line">//    [subject2 sendCompleted]; // 或2</div><div class="line">[subject sendNext:@4];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">//ignore:忽略一些值</div><div class="line">//ignoreValues:表示忽略所有的值</div><div class="line">// 1.创建信号</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">// 2.忽略一些值</div><div class="line">RACSignal *ignoreSignal = [subject ignore:@2]; // ignoreValues:表示忽略所有的值</div><div class="line">// 3.订阅信号</div><div class="line">[ignoreSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 4.发送数据</div><div class="line">[subject sendNext:@2];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// 一般和文本框一起用，添加过滤条件</div><div class="line">// 只有当文本框的内容长度大于5，才获取文本框里的内容</div><div class="line">[[self.textField.rac_textSignal filter:^BOOL(id value) &#123;</div><div class="line">// value 源信号的内容</div><div class="line">return [value length] &gt; 5;</div><div class="line">// 返回值 就是过滤条件。只有满足这个条件才能获取到内容</div><div class="line">&#125;] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h2 id="RAC-映射-1"><a href="#RAC-映射-1" class="headerlink" title="RAC-映射"></a>RAC-映射</h2><h3 id="RAC的映射在实际开发中有什么用呢？比如我们想要拦截服务器返回的数据，给数据拼接特定的东西或想对数据进行操作从而更改返回值，类似于这样的情况下，我们便可以考虑用RAC的映射，实例代码如下"><a href="#RAC的映射在实际开发中有什么用呢？比如我们想要拦截服务器返回的数据，给数据拼接特定的东西或想对数据进行操作从而更改返回值，类似于这样的情况下，我们便可以考虑用RAC的映射，实例代码如下" class="headerlink" title="RAC的映射在实际开发中有什么用呢？比如我们想要拦截服务器返回的数据，给数据拼接特定的东西或想对数据进行操作从而更改返回值，类似于这样的情况下，我们便可以考虑用RAC的映射，实例代码如下"></a>RAC的映射在实际开发中有什么用呢？比如我们想要拦截服务器返回的数据，给数据拼接特定的东西或想对数据进行操作从而更改返回值，类似于这样的情况下，我们便可以考虑用RAC的映射，实例代码如下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (void)map &#123;</div><div class="line">// 创建信号</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">// 绑定信号</div><div class="line">RACSignal *bindSignal = [subject map:^id(id value) &#123;</div><div class="line"></div><div class="line">// 返回的类型就是你需要映射的值</div><div class="line">return [NSString stringWithFormat:@&quot;ws:%@&quot;, value]; //这里将源信号发送的“123” 前面拼接了ws：</div><div class="line">&#125;];</div><div class="line">// 订阅绑定信号</div><div class="line">[bindSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[subject sendNext:@&quot;123&quot;];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (void)flatMap &#123;</div><div class="line">// 创建信号</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">// 绑定信号</div><div class="line">RACSignal *bindSignal = [subject flattenMap:^RACStream *(id value) &#123;</div><div class="line">// block：只要源信号发送内容就会调用</div><div class="line">// value: 就是源信号发送的内容</div><div class="line">// 返回信号用来包装成修改内容的值</div><div class="line">return [RACReturnSignal return:value];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// flattenMap中返回的是什么信号，订阅的就是什么信号(那么，x的值等于value的值，如果我们操纵value的值那么x也会随之而变)</div><div class="line">// 订阅信号</div><div class="line">[bindSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送数据</div><div class="line">[subject sendNext:@&quot;123&quot;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">-(void)flattenMap2&#123;</div><div class="line">// flattenMap 主要用于信号中的信号</div><div class="line">// 创建信号</div><div class="line">RACSubject *signalofSignals = [RACSubject subject];</div><div class="line">RACSubject *signal = [RACSubject subject];</div><div class="line"></div><div class="line">// 订阅信号</div><div class="line">//方式1</div><div class="line">//    [signalofSignals subscribeNext:^(id x) &#123;</div><div class="line">//</div><div class="line">//        [x subscribeNext:^(id x) &#123;</div><div class="line">//            NSLog(@&quot;%@&quot;, x);</div><div class="line">//        &#125;];</div><div class="line">//    &#125;];</div><div class="line">// 方式2</div><div class="line">//    [signalofSignals.switchToLatest  ];</div><div class="line">// 方式3</div><div class="line">//   RACSignal *bignSignal = [signalofSignals flattenMap:^RACStream *(id value) &#123;</div><div class="line">//</div><div class="line">//        //value:就是源信号发送内容</div><div class="line">//        return value;</div><div class="line">//    &#125;];</div><div class="line">//    [bignSignal subscribeNext:^(id x) &#123;</div><div class="line">//        NSLog(@&quot;%@&quot;, x);</div><div class="line">//    &#125;];</div><div class="line">// 方式4--------也是开发中常用的</div><div class="line">[[signalofSignals flattenMap:^RACStream *(id value) &#123;</div><div class="line">return value;</div><div class="line">&#125;] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号</div><div class="line">[signalofSignals sendNext:signal];</div><div class="line">[signal sendNext:@&quot;123&quot;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="RAC-组合-1"><a href="#RAC-组合-1" class="headerlink" title="RAC-组合"></a>RAC-组合</h2><h3 id="把多个信号聚合成你想要的信号-比如-当多个输入框都有值的时候按钮才可点击"><a href="#把多个信号聚合成你想要的信号-比如-当多个输入框都有值的时候按钮才可点击" class="headerlink" title="把多个信号聚合成你想要的信号,(比如-当多个输入框都有值的时候按钮才可点击)"></a>把多个信号聚合成你想要的信号,(比如-当多个输入框都有值的时候按钮才可点击)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// 思路--- 就是把输入框输入值的信号都聚合成按钮是否能点击的信号。</div><div class="line">- (void)combineLatest &#123;</div><div class="line">RACSignal *combinSignal = [RACSignal combineLatest:@[self.accountField.rac_textSignal, self.pwdField.rac_textSignal] reduce:^id(NSString *account, NSString *pwd)&#123; //reduce里的参数一定要和combineLatest数组里的一一对应。</div><div class="line">// block: 只要源信号发送内容，就会调用，组合成一个新值。</div><div class="line">NSLog(@&quot;%@ %@&quot;, account, pwd);</div><div class="line">return @(account.length &amp;&amp; pwd.length);</div><div class="line">&#125;];</div><div class="line">//    // 订阅信号</div><div class="line">//    [combinSignal subscribeNext:^(id x) &#123;</div><div class="line">//        self.loginBtn.enabled = [x boolValue];</div><div class="line">//    &#125;];    // ----这样写有些麻烦，可以直接用RAC宏</div><div class="line">RAC(self.loginBtn, enabled) = combinSignal;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">- (void)zipWith &#123;</div><div class="line">//zipWith:把两个信号压缩成一个信号，只有当两个信号同时发出信号内容时，并且把两个信号的内容合并成一个元祖，才会触发压缩流的next事件。</div><div class="line">// 创建信号A</div><div class="line">RACSubject *signalA = [RACSubject subject];</div><div class="line">// 创建信号B</div><div class="line">RACSubject *signalB = [RACSubject subject];</div><div class="line">// 压缩成一个信号</div><div class="line">// **-zipWith-**: 当一个界面多个请求的时候，要等所有请求完成才更新UI</div><div class="line">// 等所有信号都发送内容的时候才会调用</div><div class="line">RACSignal *zipSignal = [signalA zipWith:signalB];</div><div class="line">[zipSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x); //所有的值都被包装成了元组</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 发送信号 交互顺序，元组内元素的顺序不会变，跟发送的顺序无关，而是跟压缩的顺序有关[signalA zipWith:signalB]---先是A后是B</div><div class="line">[signalA sendNext:@1];</div><div class="line">[signalB sendNext:@2];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// 任何一个信号请求完成都会被订阅到</div><div class="line">// merge:多个信号合并成一个信号，任何一个信号有新值就会调用</div><div class="line">- (void)merge&#123;</div><div class="line">// 创建信号A</div><div class="line">RACSubject *signalA = [RACSubject subject];</div><div class="line">// 创建信号B</div><div class="line">RACSubject *signalB = [RACSubject subject];</div><div class="line">//组合信号</div><div class="line">RACSignal *mergeSignal = [signalA merge:signalB];</div><div class="line">// 订阅信号</div><div class="line">[mergeSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">// 发送信号---交换位置则数据结果顺序也会交换</div><div class="line">[signalB sendNext:@&quot;下部分&quot;];</div><div class="line">[signalA sendNext:@&quot;上部分&quot;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">// then --- 使用需求：有两部分数据：想让上部分先进行网络请求但是过滤掉数据，然后进行下部分的，拿到下部分数据</div><div class="line">- (void)then &#123;</div><div class="line">// 创建信号A</div><div class="line">RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求</div><div class="line">NSLog(@&quot;----发送上部分请求---afn&quot;);</div><div class="line"></div><div class="line">[subscriber sendNext:@&quot;上部分数据&quot;];</div><div class="line">[subscriber sendCompleted]; // 必须要调用sendCompleted方法！</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 创建信号B，</div><div class="line">RACSignal *signalsB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求</div><div class="line">NSLog(@&quot;--发送下部分请求--afn&quot;);</div><div class="line">[subscriber sendNext:@&quot;下部分数据&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line">// 创建组合信号</div><div class="line">// then;忽略掉第一个信号的所有值</div><div class="line">RACSignal *thenSignal = [signalA then:^RACSignal *&#123;</div><div class="line">// 返回的信号就是要组合的信号</div><div class="line">return signalsB;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 订阅信号</div><div class="line">[thenSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">// concat----- 使用需求：有两部分数据：想让上部分先执行，完了之后再让下部分执行（都可获取值）</div><div class="line">- (void)concat &#123;</div><div class="line">// 创建信号A</div><div class="line">RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求</div><div class="line">// NSLog(@&quot;----发送上部分请求---afn&quot;);</div><div class="line">[subscriber sendNext:@&quot;上部分数据&quot;];</div><div class="line">[subscriber sendCompleted]; // 必须要调用sendCompleted方法！</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 创建信号B，</div><div class="line">RACSignal *signalsB = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">// 发送请求</div><div class="line">// NSLog(@&quot;--发送下部分请求--afn&quot;);</div><div class="line">[subscriber sendNext:@&quot;下部分数据&quot;];</div><div class="line">return nil;</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// concat:按顺序去链接</div><div class="line">//**-注意-**：concat，第一个信号必须要调用sendCompleted</div><div class="line">// 创建组合信号</div><div class="line">RACSignal *concatSignal = [signalA concat:signalsB];</div><div class="line">// 订阅组合信号</div><div class="line">[concatSignal subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;,x);</div><div class="line">&#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/12/NSInvocation/" itemprop="url">
                  NSInvocation
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-12T17:25:19+08:00" content="Mar 12 2018">
              Mar 12 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="NSInvocation"><a href="#NSInvocation" class="headerlink" title="NSInvocation"></a>NSInvocation</h1><h2 id="一、概念"><a href="#一、概念" class="headerlink" title="一、概念"></a>一、概念</h2><h3 id="在-iOS中可以直接调用某个对象的消息方式有两种："><a href="#在-iOS中可以直接调用某个对象的消息方式有两种：" class="headerlink" title="在 iOS中可以直接调用某个对象的消息方式有两种："></a>在 iOS中可以直接调用某个对象的消息方式有两种：</h3><ul>
<li>performSelector:withObject（两个以上参数使用比较麻烦）</li>
<li>NSInvocation（参数个数没有限制）<h2 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    [self performSelector:@selector(sendMessage:) withObject:@&quot;performSelector&quot;];</div><div class="line">    </div><div class="line">    //没有返回值</div><div class="line">    [self createInvocation];</div><div class="line">    </div><div class="line">    //有返回值</div><div class="line">    [self returnValueInvocation];</div><div class="line">&#125;</div><div class="line">- (void)createInvocation</div><div class="line">&#123;</div><div class="line">    //NSInvocation;用来包装方法和对应的对象，它可以存储方法的名称，对应的对象，对应的参数,</div><div class="line">    /*</div><div class="line">     NSMethodSignature：签名：再创建NSMethodSignature的时候，必须传递一个签名对象，签名对象的作用：用于获取参数的个数和方法的返回值</div><div class="line">     */</div><div class="line">    //创建签名对象的时候不是使用NSMethodSignature这个类创建，而是方法属于谁就用谁来创建</div><div class="line">    NSMethodSignature *signature = [ViewController instanceMethodSignatureForSelector:@selector(sendMessage:)];</div><div class="line">    //1、创建NSInvocation对象</div><div class="line">    NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:signature];</div><div class="line">    invocation.target = self;</div><div class="line">    //invocation中的方法必须和签名中的方法一致。</div><div class="line">    invocation.selector = @selector(sendMessage:);</div><div class="line">    /*第一个参数：需要给指定方法传递的值</div><div class="line">     第一个参数需要接收一个指针，也就是传递值的时候需要传递地址*/</div><div class="line">    //第二个参数：需要给指定方法的第几个参数传值</div><div class="line">    NSString *number = @&quot;NSInvocation&quot;;</div><div class="line">    //注意：设置参数的索引时不能从0开始，因为0已经被self占用，1已经被_cmd占用</div><div class="line">    [invocation setArgument:&amp;number atIndex:2];</div><div class="line">    //2、调用NSInvocation对象的invoke方法</div><div class="line">    //只要调用invocation的invoke方法，就代表需要执行NSInvocation对象中制定对象的指定方法，并且传递指定的参数</div><div class="line">    [invocation invoke];</div><div class="line">&#125;</div><div class="line">- (void)returnValueInvocation</div><div class="line">&#123;</div><div class="line">    SEL myMethod = @selector(returnMessage:parm:parm:);</div><div class="line">    NSMethodSignature *sig  = [[self class] instanceMethodSignatureForSelector:myMethod];</div><div class="line">    NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:sig];</div><div class="line">    [invocation setTarget:self];</div><div class="line">    [invocation setSelector:myMethod];</div><div class="line">    int a=1;</div><div class="line">    int b=2;</div><div class="line">    int c=3;</div><div class="line">    [invocation setArgument:&amp;a atIndex:2];</div><div class="line">    [invocation setArgument:&amp;b atIndex:3];</div><div class="line">    [invocation setArgument:&amp;c atIndex:4];</div><div class="line">    </div><div class="line">    [invocation invoke];</div><div class="line">    //获取返回值类型</div><div class="line">    const char * returnValueType = sig.methodReturnType;</div><div class="line">    //声明一个返回值变量 (arc模式下，getReturnValue：仅仅是从invocation的返回值拷贝到指定的内存地址，如果返回值是一个NSObject对象的话，是没有处理起内存管理的。而我们在定义resultSet时使用的是__strong类型的指针对象，arc就会假设该内存块已被retain（实际没有），当resultSet出了定义域释放时，导致该crash。假如在定义之前有赋值的话，还会造成内存泄露的问题。)</div><div class="line">     __unsafe_unretained NSObject *returnValue = nil;</div><div class="line">    </div><div class="line">    //如果没有返回值，也就是消息声明为void，那么returnValue ＝ nil</div><div class="line">    if (!strcmp(returnValueType, @encode(void))) &#123;</div><div class="line">        NSLog(@&quot;没有返回值，即返回值类型为void&quot;);</div><div class="line">        returnValue = nil;</div><div class="line">    &#125;else if (!strcmp(returnValueType, @encode(id)))&#123;</div><div class="line">        //如果返回值为对象，那么为变量赋值</div><div class="line">        NSLog(@&quot;返回值类型为对象&quot;);</div><div class="line">        [invocation getReturnValue:&amp;returnValueType];</div><div class="line">    &#125;else &#123;</div><div class="line">        //如果返回值为普通类型，如NSInteger， NSUInteger ，BOOL等</div><div class="line">        NSLog(@&quot;返回类型为普通类型&quot;);</div><div class="line">        //首先获取返回值长度</div><div class="line">        NSUInteger returnValueLenth = sig.methodReturnLength;</div><div class="line">        //根据长度申请内存</div><div class="line">        void *retValue = (void *)malloc(returnValueLenth);</div><div class="line">        //为retValue赋值</div><div class="line">        [invocation getReturnValue:retValue];</div><div class="line">        </div><div class="line">        if (!strcmp(returnValueType, @encode(BOOL))) &#123;</div><div class="line">            returnValue = [NSNumber numberWithBool:*((BOOL *)retValue)];</div><div class="line">        &#125;else if (!strcmp(returnValueType, @encode(NSInteger)))&#123;</div><div class="line">            returnValue = [NSNumber numberWithInteger:*((NSInteger *) retValue)];</div><div class="line">        &#125;else if (!strcmp(returnValueType, @encode(int)))&#123;</div><div class="line">            returnValue = [NSNumber numberWithInt:*((int *) retValue)];</div><div class="line">        &#125;</div><div class="line">        // 、、、其他类型</div><div class="line">    &#125;</div><div class="line">    NSLog(@&quot;返回值是：%@&quot;, returnValue);</div><div class="line">&#125;</div><div class="line">- (void)sendMessage:(NSString*)message&#123;</div><div class="line">    NSLog(@&quot;%@调用了方法&quot;,message);</div><div class="line">&#125;</div><div class="line">- (int)returnMessage:(int)a parm:(int)b parm:(int)c&#123;</div><div class="line">    NSLog(@&quot;MyLog%d:%d:%d&quot;,a,b,c);</div><div class="line">    return a+b+c;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CTMediator[12211:1876597] performSelector调用了方法</div><div class="line">CTMediator[12211:1876597] NSInvocation调用了方法</div><div class="line">CTMediator[12211:1876597] MyLog1:2:3</div><div class="line">CTMediator[12211:1876597] 返回类型为普通类型</div><div class="line">CTMediator[12211:1876597] 返回值是：6</div></pre></td></tr></table></figure>
<h3 id="Objective-C类型编码对应表为："><a href="#Objective-C类型编码对应表为：" class="headerlink" title="Objective-C类型编码对应表为："></a>Objective-C类型编码对应表为：</h3><table>
<thead>
<tr>
<th>编码</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>c</td>
<td>char</td>
</tr>
<tr>
<td>i</td>
<td>int</td>
</tr>
<tr>
<td>s</td>
<td>short</td>
</tr>
<tr>
<td>l</td>
<td>long在64位程序中，l为32位</td>
</tr>
<tr>
<td>q</td>
<td>long long</td>
</tr>
<tr>
<td>C</td>
<td>unsigned char</td>
</tr>
<tr>
<td>I</td>
<td>unsigned int</td>
</tr>
<tr>
<td>S</td>
<td>unsigned short</td>
</tr>
<tr>
<td>L</td>
<td>unsigned long</td>
</tr>
<tr>
<td>Q</td>
<td>unsigned long long</td>
</tr>
<tr>
<td>f</td>
<td>float</td>
</tr>
<tr>
<td>d</td>
<td>double</td>
</tr>
<tr>
<td>B</td>
<td>C++标准的bool或者C99标准的_Bool</td>
</tr>
<tr>
<td>v</td>
<td>void</td>
</tr>
<tr>
<td>*</td>
<td>字符串（char *）</td>
</tr>
<tr>
<td>@</td>
<td>对象（无论是静态指定的还是通过id引用的）</td>
</tr>
<tr>
<td>#</td>
<td>类（class）</td>
</tr>
<tr>
<td>:</td>
<td>方法选标（SEL）</td>
</tr>
<tr>
<td>[array type]</td>
<td>数组</td>
</tr>
<tr>
<td>{name=type…}</td>
<td>结构体</td>
</tr>
<tr>
<td>(name=type…)</td>
<td>联合体</td>
</tr>
<tr>
<td>bnum</td>
<td>num个bit的位域</td>
</tr>
<tr>
<td>^type</td>
<td>type类型的指针</td>
</tr>
<tr>
<td>?</td>
<td>未知类型（其他的情况，一般用来指函数指针</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/11/UIViewContentMode小记/" itemprop="url">
                  UIViewContentMode小记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-11T18:25:19+08:00" content="Jan 11 2018">
              Jan 11 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="UIViewContentMode小记"><a href="#UIViewContentMode小记" class="headerlink" title="UIViewContentMode小记"></a>UIViewContentMode小记</h1><h2 id="开发中经常会出现服务器下载图片的尺寸比例与UI上不一致的问题，这时我们需要设置图片的contentMode来进行适配。"><a href="#开发中经常会出现服务器下载图片的尺寸比例与UI上不一致的问题，这时我们需要设置图片的contentMode来进行适配。" class="headerlink" title="开发中经常会出现服务器下载图片的尺寸比例与UI上不一致的问题，这时我们需要设置图片的contentMode来进行适配。"></a>开发中经常会出现服务器下载图片的尺寸比例与UI上不一致的问题，这时我们需要设置图片的contentMode来进行适配。</h2><h3 id="属性如下："><a href="#属性如下：" class="headerlink" title="属性如下："></a>属性如下：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">typedef NS_ENUM(NSInteger, UIViewContentMode) &#123;</div><div class="line">//图片拉伸填充至整个UIImageView(图片可能会变形),这也是默认的属性,如果什么都不设置就是它在起作用</div><div class="line">    UIViewContentModeScaleToFill,</div><div class="line">//图片拉伸至完全显示在UIImageView里面为止(图片不会变形)</div><div class="line">    UIViewContentModeScaleAspectFit,</div><div class="line">//图片拉伸至图片的的宽度或者高度等于UIImageView的宽度或者高度为止.看图片的宽高哪一边最接近UIImageView的宽高,一个属性相等后另一个就停止拉伸.</div><div class="line">    UIViewContentModeScaleAspectFill,</div><div class="line">//调用setNeedsDisplay 方法时,就会重新渲染图片</div><div class="line"></div><div class="line">//下面的属性都是不会拉伸图片的</div><div class="line">    UIViewContentModeRedraw,</div><div class="line">//中间模式</div><div class="line">    UIViewContentModeCenter, </div><div class="line">//顶部</div><div class="line">    UIViewContentModeTop,</div><div class="line">//底部</div><div class="line">    UIViewContentModeBottom,</div><div class="line">//左边</div><div class="line">    UIViewContentModeLeft,</div><div class="line">//右边</div><div class="line">    UIViewContentModeRight,</div><div class="line">//左上</div><div class="line">    UIViewContentModeTopLeft,</div><div class="line">//右上</div><div class="line">    UIViewContentModeTopRight,</div><div class="line">//左下</div><div class="line">    UIViewContentModeBottomLeft,</div><div class="line">//右下</div><div class="line">    UIViewContentModeBottomRight,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="测试原图如下："><a href="#测试原图如下：" class="headerlink" title="测试原图如下："></a>测试原图如下：</h3><p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/v.jpg" alt=""><br><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/h.jpg" alt=""></p>
<h3 id="默认（UIViewContentModeScaleToFill）"><a href="#默认（UIViewContentModeScaleToFill）" class="headerlink" title="默认（UIViewContentModeScaleToFill）"></a>默认（UIViewContentModeScaleToFill）</h3><p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/UIViewContentModeScaleToFill.png" alt=""></p>
<h3 id="UIViewContentModeScaleAspectFit"><a href="#UIViewContentModeScaleAspectFit" class="headerlink" title="UIViewContentModeScaleAspectFit"></a>UIViewContentModeScaleAspectFit</h3><p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/UIViewContentModeScaleAspectFit.png" alt=""></p>
<h3 id="UIViewContentModeScaleToFill"><a href="#UIViewContentModeScaleToFill" class="headerlink" title="UIViewContentModeScaleToFill"></a>UIViewContentModeScaleToFill</h3><p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/UIViewContentModeScaleToFill.png" alt=""></p>
<h3 id="UIViewContentModeScaleAspectFill"><a href="#UIViewContentModeScaleAspectFill" class="headerlink" title="UIViewContentModeScaleAspectFill"></a>UIViewContentModeScaleAspectFill</h3><p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/UIViewContentModeScaleAspectFill.png" alt=""></p>
<h3 id="UIViewContentModeCenter"><a href="#UIViewContentModeCenter" class="headerlink" title="UIViewContentModeCenter"></a>UIViewContentModeCenter</h3><p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/UIViewContentModeCenter.png" alt=""></p>
<h3 id="如果想让图片占满整个父容器-并且不变形-可以采用一种折中的方式"><a href="#如果想让图片占满整个父容器-并且不变形-可以采用一种折中的方式" class="headerlink" title="如果想让图片占满整个父容器,并且不变形,可以采用一种折中的方式"></a>如果想让图片占满整个父容器,并且不变形,可以采用一种折中的方式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">image1.contentMode = UIViewContentModeScaleAspectFill;</div><div class="line">image1.clipsToBounds = YES;</div></pre></td></tr></table></figure>
<p><img src="https://boke-1256188736.cos.ap-chengdu.myqcloud.com/clipsToBounds.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/03/NSDecimalNumber 货币单位/" itemprop="url">
                  货币金额处理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-03T16:58:13+08:00" content="Jan 3 2018">
              Jan 3 2018
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="在iOS开发中，经常遇到货币金额的表示与计算，你可能会使用-double-或-float-这样的浮点数，也可能使用-NSString-。无论用哪个，都需要再编写繁琐的精度控制、小数位数控制等代码。其实，苹果为我们提供了一个标准类-NSDecimalNumber-来处理这样的需求。"><a href="#在iOS开发中，经常遇到货币金额的表示与计算，你可能会使用-double-或-float-这样的浮点数，也可能使用-NSString-。无论用哪个，都需要再编写繁琐的精度控制、小数位数控制等代码。其实，苹果为我们提供了一个标准类-NSDecimalNumber-来处理这样的需求。" class="headerlink" title="在iOS开发中，经常遇到货币金额的表示与计算，你可能会使用 double 或 float 这样的浮点数，也可能使用 NSString 。无论用哪个，都需要再编写繁琐的精度控制、小数位数控制等代码。其实，苹果为我们提供了一个标准类 NSDecimalNumber 来处理这样的需求。"></a>在iOS开发中，经常遇到货币金额的表示与计算，你可能会使用 double 或 float 这样的浮点数，也可能使用 NSString 。无论用哪个，都需要再编写繁琐的精度控制、小数位数控制等代码。其实，苹果为我们提供了一个标准类 <strong>NSDecimalNumber</strong> 来处理这样的需求。</h2><h2 id="NSDecimalNumber-是-NSNumber-的子类，它提供了完善的初始化方法。对于令人头疼的金额计算，它还提供了贴心的加、减、乘、除运算方法。在进行这些运算的时候，你还可以通过-NSDecimalNumberHandler-对象来对运算的处理策略进行设置，比如舍入模式的选择，数据溢出、除零等异常情况的处理等。"><a href="#NSDecimalNumber-是-NSNumber-的子类，它提供了完善的初始化方法。对于令人头疼的金额计算，它还提供了贴心的加、减、乘、除运算方法。在进行这些运算的时候，你还可以通过-NSDecimalNumberHandler-对象来对运算的处理策略进行设置，比如舍入模式的选择，数据溢出、除零等异常情况的处理等。" class="headerlink" title="NSDecimalNumber 是 NSNumber 的子类，它提供了完善的初始化方法。对于令人头疼的金额计算，它还提供了贴心的加、减、乘、除运算方法。在进行这些运算的时候，你还可以通过 NSDecimalNumberHandler 对象来对运算的处理策略进行设置，比如舍入模式的选择，数据溢出、除零等异常情况的处理等。"></a>NSDecimalNumber 是 NSNumber 的子类，它提供了完善的初始化方法。对于令人头疼的金额计算，它还提供了贴心的加、减、乘、除运算方法。在进行这些运算的时候，你还可以通过 NSDecimalNumberHandler 对象来对运算的处理策略进行设置，比如舍入模式的选择，数据溢出、除零等异常情况的处理等。</h2><p>参考：</p>
<p><a href="https://www.jianshu.com/p/ea4da259a062" target="_blank" rel="external">iOS 数字精准计算之NSDecimalNumber</a><br><a href="https://www.jianshu.com/p/25d24a184016" target="_blank" rel="external">NSDecimalNumber数字精确</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-积累 " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/12/layoutSubviews调用/" itemprop="url">
                  layoutSubviews调用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-12T17:25:19+08:00" content="Nov 12 2017">
              Nov 12 2017
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在以下情况都会调用"><a href="#在以下情况都会调用" class="headerlink" title="在以下情况都会调用"></a>在以下情况都会调用</h1><h2 id="1-直接调用-self-setNeedsLayout"><a href="#1-直接调用-self-setNeedsLayout" class="headerlink" title="1. 直接调用[self setNeedsLayout]"></a>1. 直接调用[self setNeedsLayout]</h2><h2 id="2-addSubview的时候"><a href="#2-addSubview的时候" class="headerlink" title="2. addSubview的时候"></a>2. addSubview的时候</h2><h2 id="3-当view的size发生改变的时候"><a href="#3-当view的size发生改变的时候" class="headerlink" title="3. 当view的size发生改变的时候"></a>3. 当view的size发生改变的时候</h2><h2 id="4-滑动UIScrollView的时候"><a href="#4-滑动UIScrollView的时候" class="headerlink" title="4.滑动UIScrollView的时候"></a>4.滑动UIScrollView的时候</h2><h2 id="5-旋转Screen会触发父UIView上的layoutSubviews事件"><a href="#5-旋转Screen会触发父UIView上的layoutSubviews事件" class="headerlink" title="5.旋转Screen会触发父UIView上的layoutSubviews事件"></a>5.旋转Screen会触发父UIView上的layoutSubviews事件</h2><h1 id="注意-当view的size的值为0的时候，addSubview也不会调用layoutSubviews。当要给这个view添加子控件的时候不管他的size有没有值都会调用"><a href="#注意-当view的size的值为0的时候，addSubview也不会调用layoutSubviews。当要给这个view添加子控件的时候不管他的size有没有值都会调用" class="headerlink" title="(注意:当view的size的值为0的时候，addSubview也不会调用layoutSubviews。当要给这个view添加子控件的时候不管他的size有没有值都会调用)."></a>(注意:当view的size的值为0的时候，addSubview也不会调用layoutSubviews。当要给这个view添加子控件的时候不管他的size有没有值都会调用).</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/12/一键搞定代码块/" itemprop="url">
                  一键导入代码块
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-12T16:58:13+08:00" content="Nov 12 2017">
              Nov 12 2017
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一键导入代码块"><a href="#一键导入代码块" class="headerlink" title="一键导入代码块"></a>一键导入代码块</h1><h2 id="之前弄过代码块，但是每次换电脑或者重装Xcode忘记备份就杯具了，最近看网上有个比较方便的方法。"><a href="#之前弄过代码块，但是每次换电脑或者重装Xcode忘记备份就杯具了，最近看网上有个比较方便的方法。" class="headerlink" title="之前弄过代码块，但是每次换电脑或者重装Xcode忘记备份就杯具了，最近看网上有个比较方便的方法。"></a>之前弄过代码块，但是每次换电脑或者重装Xcode忘记备份就杯具了，最近看网上有个比较方便的方法。</h2><p>使用:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd CodeSnippets</div><div class="line">./createSnippets.sh</div><div class="line">成功之后输出:</div><div class="line">done</div></pre></td></tr></table></figure></p>
<p><strong>完全退出</strong>Xcode后重新新打开Xcode</p>
<p>删除代码块:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./deleteSnippets.sh</div></pre></td></tr></table></figure></p>
<p>清除Xcode 缓存垃圾,释放磁盘存储空间:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./clearTempData.sh</div></pre></td></tr></table></figure></p>
<p>打开代码块所在位置:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./openCodeSnippets.sh</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">或者手动打开: Finder-&gt;前往-&gt;前往文件夹</div><div class="line">~/Library/Developer/Xcode/UserData/CodeSnippets/</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>调用</th>
<th>实现  </th>
</tr>
</thead>
<tbody>
<tr>
<td>D Button</td>
<td>一键创建UIButton</td>
</tr>
<tr>
<td>D TableView</td>
<td>一键创建UITabelView</td>
</tr>
<tr>
<td>D Label</td>
<td>一键创建UILabel</td>
</tr>
<tr>
<td>D Label+Custom</td>
<td>一键 Label自适应宽高</td>
</tr>
<tr>
<td>D PickerView</td>
<td>一键自定义UIPickerView</td>
</tr>
<tr>
<td>D Window</td>
<td>一键创建UIWindow</td>
</tr>
<tr>
<td>D CornerRadius</td>
<td>一键设置圆角</td>
</tr>
<tr>
<td>D Dispatch_async</td>
<td>一键 子 -&gt; 主 线程(GCD)</td>
</tr>
<tr>
<td>D Timer</td>
<td>一键 NSTimer 带暂停/开始</td>
</tr>
<tr>
<td>D ImageView</td>
<td>一键 UIImageView 圆角+边框</td>
</tr>
<tr>
<td>D Switch</td>
<td>一键创建 UISwitch 附带 点击Action</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D TextField</td>
<td>一键创建 UITextField<br>自定义 清除按键 img <br>是否密文输入 placeholder</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D ScrollView</td>
<td>一键创建 UIScrollView</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D PageControl</td>
<td>一键创建 UIPageControl</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D Slider</td>
<td>一键创建滑块 附带 值改变 拖动结束 method</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D ///</td>
<td>一键注释</td>
<td>触发 { }</td>
</tr>
<tr>
<td>D interface</td>
<td>一键添加 interface</td>
<td>#import 下面  触发</td>
</tr>
<tr>
<td>D Assign</td>
<td>一键 声明 assign 属性</td>
<td>interface 内触发</td>
</tr>
<tr>
<td>D Copy</td>
<td>一键 声明 copy 属性</td>
<td>interface 内触发</td>
</tr>
<tr>
<td>D Weak</td>
<td>一键 weak 属性</td>
<td>interface 内触发</td>
</tr>
<tr>
<td>D Strong</td>
<td>一键 声明 Strong 属性</td>
<td>interface 内触发</td>
</tr>
<tr>
<td>D Mark</td>
<td>一键 mark</td>
<td>触发 {  }</td>
</tr>
<tr>
<td>D docPath</td>
<td>一键生成 documentPath</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D NSNotificationCenter</td>
<td>一键发送 接收通知</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D ActivityIndicatorView</td>
<td>一键 正在加载..(菊花)  转起来 暂停</td>
<td>{ 触发 }  </td>
</tr>
<tr>
<td>D AlertController</td>
<td>一键创建 警告框 附带 确定 取消 回调</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D AlertController<br>UserNamePwdTextField</td>
<td>一键创建UIAlertController<br>附带Username/PwdTextField</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D PlayMusic</td>
<td>一键播放音频文件</td>
<td>触发 { }</td>
</tr>
<tr>
<td>D SegmentedControl<br>duogeyipaianjian</td>
<td>一键创建一排按键 多格按键 附带点击action</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D hide_keyboard</td>
<td>一键 点击 view 隐藏键盘</td>
<td>触发 {  }</td>
</tr>
<tr>
<td>D RequestDelegate</td>
<td>一键创建networkRequestDelegate</td>
<td>触发 {  }</td>
</tr>
<tr>
<td>D WebView</td>
<td>一键创建 UIWebView 附带Delegate</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D AFN_网络状态改变的时候触发</td>
<td>一键监听网络状态:<br> 蜂窝网络, 无网络,<br> wifi网络变化时触发回调</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D AFN_Upload</td>
<td>利用AFNetworking3.1.0封装的两种上传文件方式</td>
<td>触发 { }</td>
</tr>
<tr>
<td>D AFN_Get</td>
<td>一键生成 AFNetworking get 网络请求</td>
<td>触发 { }</td>
</tr>
<tr>
<td>D AFN_POST</td>
<td>一键生成 AFNetworking POST 网络请求 带进度</td>
<td>触发 { }</td>
</tr>
<tr>
<td>D AFN_Download</td>
<td>一键生成 AFNetworking Download<br>带下载进度 自定义存储filepath</td>
<td>触发 { }</td>
</tr>
<tr>
<td>D POST_yuansheng</td>
<td>一键生成 ios 原生 POST 网络请求,<br>post 参数(可选) <br>自定义请求头 HTTPHeader (可选)<br>支持: application/x-www-form-urlencoded<br>multipart/form-data  两种类型 POST</td>
<td>{ 触发 }</td>
</tr>
<tr>
<td>D PCH</td>
<td>一键定义常用宏</td>
<td>#ifndef PrefixHeader_pch<br>#define PrefixHeader_pch<br>触发 D PCH <br>#endif</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/23/UIAlterController使用/" itemprop="url">
                  UIAlterController使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-23T14:58:13+08:00" content="Oct 23 2017">
              Oct 23 2017
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前两天加了一个actionSheet，忘记针对iPad适配，导致悲剧了😭，今天顺便就在复习一下。"><a href="#前两天加了一个actionSheet，忘记针对iPad适配，导致悲剧了😭，今天顺便就在复习一下。" class="headerlink" title="前两天加了一个actionSheet，忘记针对iPad适配，导致悲剧了😭，今天顺便就在复习一下。"></a>前两天加了一个actionSheet，忘记针对iPad适配，导致悲剧了😭，今天顺便就在复习一下。</h2><p>自iOS 8开始，UIAlertController就取代了UIAlertView和UIAlertSheet。</p>
<h2 id="创建一个demo看看"><a href="#创建一个demo看看" class="headerlink" title="创建一个demo看看"></a>创建一个demo看看</h2><h3 id="1-简单的对话框"><a href="#1-简单的对话框" class="headerlink" title="1 简单的对话框"></a>1 简单的对话框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (void)showAlertView</div><div class="line">&#123;</div><div class="line">    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:@&quot;demo&quot; message:nil preferredStyle:UIAlertControllerStyleAlert];</div><div class="line"></div><div class="line">    UIAlertAction *okAction = [UIAlertAction actionWithTitle:@&quot;OK&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        NSLog(@&quot;OK Action&quot;);</div><div class="line">    &#125;];</div><div class="line">    UIAlertAction *warningAction = [UIAlertAction actionWithTitle:@&quot;warning&quot; style:UIAlertActionStyleDestructive handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        NSLog(@&quot;warning Action&quot;);</div><div class="line">    &#125;];</div><div class="line">    UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@&quot;Cancel&quot; style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        NSLog(@&quot;Cancel Action&quot;);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    [alertController addAction:okAction];</div><div class="line">    [alertController addAction:warningAction];</div><div class="line">    [alertController addAction:cancelAction];</div><div class="line">    [self presentViewController:alertController animated:YES completion:nil];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oc1jw3mv7.bkt.clouddn.com/alert.jpg" alt="alert.png"></p>
<h3 id="2-ActionSheet"><a href="#2-ActionSheet" class="headerlink" title="2 ActionSheet"></a>2 ActionSheet</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (void)showAlertView</div><div class="line">&#123;</div><div class="line">    UIAlertController *alertController = [UIAlertController alertControllerWithTitle:@&quot;demo&quot; message:nil preferredStyle:UIAlertControllerStyleActionSheet];</div><div class="line"></div><div class="line">    UIAlertAction *okAction = [UIAlertAction actionWithTitle:@&quot;OK&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        NSLog(@&quot;OK Action&quot;);</div><div class="line">    &#125;];</div><div class="line">    UIAlertAction *warningAction = [UIAlertAction actionWithTitle:@&quot;warning&quot; style:UIAlertActionStyleDestructive handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        NSLog(@&quot;warning Action&quot;);</div><div class="line">    &#125;];</div><div class="line">    UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@&quot;Cancel&quot; style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        NSLog(@&quot;Cancel Action&quot;);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    [alertController addAction:okAction];</div><div class="line">    [alertController addAction:warningAction];</div><div class="line">    [alertController addAction:cancelAction];</div><div class="line">    [self presentViewController:alertController animated:YES completion:nil];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oc1jw3mv7.bkt.clouddn.com/actionSheet.jpg" alt="actionSheet.png"></p>
<h3 id="这里的preferredStyle-参数是UIAlertControllerStyleActionSheet，如果Action-Sheet中有取消按钮，取消按钮每次都会在底部显示，其他按钮会按照添加的顺序显示。在Action-Sheet内不能添加文本框。如果你添加了文本框，在运行时会抛出下面的异常提醒："><a href="#这里的preferredStyle-参数是UIAlertControllerStyleActionSheet，如果Action-Sheet中有取消按钮，取消按钮每次都会在底部显示，其他按钮会按照添加的顺序显示。在Action-Sheet内不能添加文本框。如果你添加了文本框，在运行时会抛出下面的异常提醒：" class="headerlink" title="这里的preferredStyle:参数是UIAlertControllerStyleActionSheet，如果Action Sheet中有取消按钮，取消按钮每次都会在底部显示，其他按钮会按照添加的顺序显示。在Action Sheet内不能添加文本框。如果你添加了文本框，在运行时会抛出下面的异常提醒："></a>这里的preferredStyle:参数是UIAlertControllerStyleActionSheet，如果Action Sheet中有取消按钮，取消按钮每次都会在底部显示，其他按钮会按照添加的顺序显示。在Action Sheet内不能添加文本框。如果你添加了文本框，在运行时会抛出下面的异常提醒：</h3><blockquote>
<p><em>*</em> Terminating app due to uncaught exception<br>‘NSInternalInconsistencyException’, reason: ‘Text fields can only be added to an alert controller of style UIAlertControllerStyleAlert’</p>
</blockquote>
<p>##如上面说到的，在iPad中ActionSheet以弹出框的形式呈现，如果还是按照上面写就会崩溃。iPad弹出弹出框总是需要一个锚点，锚点可以是源视图，也可以是按钮。需要添加一下代码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alertController.popoverPresentationController.sourceView = self.view;</div><div class="line">alertController.popoverPresentationController.sourceRect = self.view.bounds;</div></pre></td></tr></table></figure></p>
<h2 id="3-退出警告控制器"><a href="#3-退出警告控制器" class="headerlink" title="3 退出警告控制器"></a>3 退出警告控制器</h2><h3 id="警报控制器会在用户点击按钮后自动消失，但在app进入后台时，警告框和选择表并不会自动退出。此时，我们需要通过代码实现退出警报控制器。"><a href="#警报控制器会在用户点击按钮后自动消失，但在app进入后台时，警告框和选择表并不会自动退出。此时，我们需要通过代码实现退出警报控制器。" class="headerlink" title="警报控制器会在用户点击按钮后自动消失，但在app进入后台时，警告框和选择表并不会自动退出。此时，我们需要通过代码实现退出警报控制器。"></a>警报控制器会在用户点击按钮后自动消失，但在app进入后台时，警告框和选择表并不会自动退出。此时，我们需要通过代码实现退出警报控制器。</h3><h3 id="在通知中心进行注册，当接收到app进入后台的通知时退出警报控制器。更新后的viewDidLoad如下"><a href="#在通知中心进行注册，当接收到app进入后台的通知时退出警报控制器。更新后的viewDidLoad如下" class="headerlink" title="在通知中心进行注册，当接收到app进入后台的通知时退出警报控制器。更新后的viewDidLoad如下"></a>在通知中心进行注册，当接收到app进入后台的通知时退出警报控制器。更新后的viewDidLoad如下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    // app 进入后台后隐藏警报控制器</div><div class="line">    [[NSNotificationCenter defaultCenter] addObserverForName:UIApplicationDidEnterBackgroundNotification object:nil queue:nil usingBlock:^(NSNotification * _Nonnull note) &#123;</div><div class="line">        [self.presentedViewController dismissViewControllerAnimated:YES completion:nil];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)dealloc</div><div class="line">&#123;</div><div class="line">    // 移除观察者</div><div class="line">    [[NSNotificationCenter defaultCenter] removeObserver:self name:UIApplicationDidEnterBackgroundNotification object:nil];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="最后一定记得移除观察者，否则会引起崩溃。"><a href="#最后一定记得移除观察者，否则会引起崩溃。" class="headerlink" title="最后一定记得移除观察者，否则会引起崩溃。"></a>最后一定记得移除观察者，否则会引起崩溃。</h2><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul>
<li>AlertView<ul>
<li>一般显示在当前视图控制器的中心，点击警告框以外区域不能隐藏警告控制器。</li>
<li>可以添加任意数量文本框。</li>
<li>有一个或两个按钮时，横向排布，如果有Cancel按钮，则Cancel按钮显示在左侧；有两个以上按钮时，竖列排布，如果有Cancel按钮，则Cancel按钮显示在最底部。其他按钮按照添加顺序排布。</li>
</ul>
</li>
<li>ActionSheet<ul>
<li>在iPhone中自下而上滑出显示在当前控制器的底部，点击action sheet以外区域可以隐藏UIAlertController。</li>
<li>在iPad中以popover方式、以源视图为锚点显示，点击选择表以外的区域可以隐藏警告控制器。</li>
<li>不能添加文本框。</li>
<li>按钮竖列排布，在iPhone中，Cancel按钮默认在底部显示；在iPad中，Cancel按钮默认不显示</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/AliPay.png"
               alt="chuandong ding" />
          <p class="site-author-name" itemprop="name">chuandong ding</p>
          <p class="site-description motion-element" itemprop="description">iOS</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">22</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/dingchuandong" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="twitter" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2725322503" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://slarker.me/" title="slarker" target="_blank">slarker</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://opsnotes.net/about/" title="大神" target="_blank">大神</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chuandong ding</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
